<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Menu AR â€“ Da Rocco Pizzeria</title>

<script type="module"
  src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Abril+Fatface&family=Merriweather:wght@300;500&display=swap');

/* GLOBAL */
body {
  margin: 0;
  font-family: 'Merriweather', serif;
  background:
    linear-gradient(rgba(0,0,0,0.65),rgba(0,0,0,0.65)),
    url("sfondo.jpg") center/cover no-repeat fixed;
  color: #f7f1e3;
  overflow: hidden;
}

/* START SCREEN */
#start {
  position: fixed;
  inset: 0;
  background: black;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 100;
}
#start button {
  font-family: 'Abril Fatface', serif;
  font-size: 26px;
  padding: 20px 60px;
  border-radius: 50px;
  border: none;
  background: linear-gradient(145deg, #d65a27, #8c2b0e);
  color: white;
  cursor: pointer;
  box-shadow: 0 4px 8px rgba(0,0,0,0.3);
}

/* HEADER */
header {
  padding: 14px;
  background: linear-gradient(#000, #0009);
}
header img {
  width: 100%;
  max-height: 160px;
  object-fit: contain;
  display: block;
  border: 3px solid #b86a1e;
  border-radius: 12px;
}

/* MENU LIST */
.menu {
  height: calc(100vh - 190px);
  overflow-y: auto;
  padding: 12px;
}
.section {
  margin-bottom: 30px;
}
.section-title {
  font-family: 'Abril Fatface', serif;
  font-size: 24px;
  margin: 8px 6px 12px;
  color: #ffcd8b;
  text-shadow: 0 1px 3px rgba(0,0,0,0.4);
}

/* SCROLLABLE LIST */
.list {
  max-height: 260px;
  overflow-y: auto;
  background: rgba(40, 25, 10, 0.85);
  border-radius: 18px;
  padding: 8px 0;
  position: relative;
}
.item {
  margin: 12px 20px;
  padding: 14px;
  background: linear-gradient(145deg, #3d2b14, #1a0e06);
  border-radius: 14px;
  text-align: center;
  font-size: 18px;
  cursor: pointer;
  border: 1px solid #6b4626;
  color: #f7f1e3;
  user-select: none;
  font-weight: 500;
}

/* HIDE AR COMPONENT */
model-viewer {
  display: none;
}
</style>
</head>

<body>

<!-- START -->
<div id="start">
  <button onclick="enter()">ENTRA</button>
</div>

<!-- AUDIO -->
<audio id="tick" src="sounds/scroll.mp3" preload="auto"></audio>
<audio id="click" src="sounds/sparo.mp3" preload="auto"></audio>
<audio id="reload" src="sounds/ricarica.mp3" preload="auto"></audio>

<!-- HEADER - Optional Logo -->
<header>
  <img src="images/intestazione.jpg" alt="Da Rocco Pizzeria Olmi">
</header>

<div class="menu">

  <!-- PIZZE SPECIALI -->
  <div class="section">
    <div class="section-title">Pizze Speciali</div>
    <div class="list" onscroll="checkCenter(this)">
      <div class="item" onclick="openAR()">Calabrese</div>
      <div class="item" onclick="openAR()">Da Rocco</div>
      <div class="item" onclick="openAR()">Olmi</div>
      <div class="item" onclick="openAR()">Peccatrice</div>
      <div class="item" onclick="openAR()">Principe</div>
    </div>
  </div>

  <!-- PIZZE CLASSICHE -->
  <div class="section">
    <div class="section-title">Pizze Classiche</div>
    <div class="list" onscroll="checkCenter(this)">
      <div class="item" onclick="openAR()">Margherita</div>
      <div class="item" onclick="openAR()">Diavola</div>
      <div class="item" onclick="openAR()">4 Formaggi</div>
    </div>
  </div>

  <!-- HAMBURGER -->
  <div class="section">
    <div class="section-title">Hamburger</div>
    <div class="list" onscroll="checkCenter(this)">
      <div class="item" onclick="openAR()">Classic Burger</div>
      <div class="item" onclick="openAR()">Louisiana Burger</div>
      <div class="item" onclick="openAR()">Da Rocco Burger</div>
    </div>
  </div>

</div>

<!-- AR 3D VIEWER -->
<model-viewer
  id="ar"
  src="models/panino.glb"
  ar
  ar-modes="scene-viewer quick-look"
  camera-controls>
</model-viewer>

<script>
let unlocked = false;
let enteredAR = false;
const lastIndex = new WeakMap();

function enter(){
  unlocked = true;
  document.getElementById("click").play();
  document.getElementById("start").style.display = "none";
}

function checkCenter(list){
  if(!unlocked) return;
  const items = list.querySelectorAll(".item");
  const center = list.scrollTop + list.clientHeight / 2;
  items.forEach((item,i) => {
    const ic = item.offsetTop + item.offsetHeight / 2;
    if(Math.abs(ic - center) < 8){
      if(lastIndex.get(list) !== i){
        lastIndex.set(list, i);
        const t = document.getElementById("tick");
        t.currentTime = 0;
        t.play();
        if(navigator.vibrate) navigator.vibrate(8);
      }
    }
  });
}

function openAR(){
  document.getElementById("click").play();
  enteredAR = true;
  document.getElementById("ar").activateAR();
}

window.addEventListener("focus", () => {
  if(unlocked && enteredAR){
    const r = document.getElementById("reload");
    r.currentTime = 0;
    r.play();
    enteredAR = false;
  }
});
</script>

</body>
</html>
